<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All the Light We Cannot See - Interactive Experience</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #0a0a0f;
      --secondary: #f7f7f9;
      --accent: #3b82f6;
      --accent-hover: #2563eb;
      --subtle: #64748b;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #3b82f6;
      --timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);
      --box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.2);
      --text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      --border-radius: 16px;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }

    /* Enhanced grainy static effect with better animation */
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.15'/%3E%3C/svg%3E");
      opacity: 0.15;
      pointer-events: none;
      z-index: 10;
      animation: noiseJump 0.3s steps(2) infinite;
    }
    
    @keyframes noiseJump {
      0% { transform: translate(0px, 0px); }
      10% { transform: translate(-2px, 1px); }
      20% { transform: translate(2px, -1px); }
      30% { transform: translate(-1px, -2px); }
      40% { transform: translate(1px, 2px); }
      50% { transform: translate(-2px, 1px); }
      60% { transform: translate(2px, -1px); }
      70% { transform: translate(-1px, -2px); }
      80% { transform: translate(1px, 2px); }
      90% { transform: translate(-2px, 1px); }
      100% { transform: translate(0px, 0px); }
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      color: var(--primary);
      background-color: var(--secondary);
      overflow-x: hidden;
      transition: background-color 0.5s var(--timing-function);
      line-height: 1.6;
    }
    
    body.dark { 
      background-color: var(--primary); 
      color: var(--secondary); 
      --box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.5);
    }
    
    .container { 
      width: 100%; 
      padding: 0; 
      position: relative; 
    }
    
    .progress-container {
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 4px;
      background: rgba(255, 255, 255, 0.1); 
      z-index: 2000;
      backdrop-filter: blur(4px);
    }
    
    .progress-bar {
      height: 100%; 
      background: linear-gradient(90deg, var(--accent), var(--accent-hover)); 
      width: 0%;
      transition: width 0.1s ease;
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
      border-radius: 0 4px 4px 0;
    }
    
    .sticky-browser {
      position: fixed; 
      top: 50%; 
      left: 50%;
      transform: translate(-50%, -50%) scale(1); 
      z-index: 100;
      width: 92%; 
      max-width: 1080px; 
      opacity: 1; 
      transform-origin: center;
      transition: opacity 0.5s var(--timing-function), transform 0.5s var(--timing-function);
      perspective: 1500px;
    }
    
    section {
      min-height: 100vh; 
      padding: 15vh 0;
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative;
    }
    
    .browser-frame {
      width: 100%; 
      max-width: 1080px; 
      background: #fff;
      border-radius: var(--border-radius); 
      box-shadow: var(--box-shadow);
      overflow: hidden; 
      margin: 0 auto;
      transition: all 0.8s var(--timing-function);
      transform: translateY(0) rotateX(0deg);
      will-change: transform;
      border: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .browser-frame:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px -5px rgba(0, 0, 0, 0.2);
    }
    
    body.dark .browser-frame {
      background: #121218;
      border-color: rgba(255, 255, 255, 0.05);
    }
    
    .browser-header {
      display: flex; 
      align-items: center; 
      padding: 16px 20px;
      background: #f0f0f5; 
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      border-radius: var(--border-radius) var(--border-radius) 0 0;
      backdrop-filter: blur(5px);
    }
    
    body.dark .browser-header {
      background: #1a1a22; 
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .browser-dots { 
      display: flex; 
      gap: 8px; 
    }
    
    .browser-dot {
      width: 12px; 
      height: 12px; 
      border-radius: 50%;
      transition: transform 0.2s var(--timing-function);
      box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.1);
    }
    
    body.dark .browser-dot {
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1);
    }
    
    .browser-dot:hover { 
      transform: scale(1.2); 
    }
    
    .browser-dot.red { 
      background: linear-gradient(145deg, #ff5f57, #ff4f47); 
    }
    
    .browser-dot.yellow { 
      background: linear-gradient(145deg, #febc2e, #feac1e); 
    }
    
    .browser-dot.green { 
      background: linear-gradient(145deg, #28c840, #18b830); 
    }
    
    .browser-address {
      flex: 1; 
      margin: 0 16px; 
      padding: 10px 16px;
      background: rgba(230, 230, 240, 0.8); 
      border-radius: 8px; 
      color: #333;
      font-size: 14px; 
      text-align: center; 
      font-family: 'Inter', sans-serif;
      white-space: nowrap; 
      overflow: hidden; 
      text-overflow: ellipsis;
      transition: all 0.3s var(--timing-function);
      box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
      backdrop-filter: blur(4px);
    }
    
    .browser-address:hover { 
      background: rgba(220, 220, 230, 0.9); 
    }
    
    body.dark .browser-address { 
      background: rgba(40, 40, 50, 0.8); 
      color: #f0f0f5; 
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
    }
    
    body.dark .browser-address:hover { 
      background: rgba(50, 50, 60, 0.9); 
    }
    
    .browser-buttons { 
      display: flex; 
      gap: 16px; 
    }
    
    .browser-button {
      color: var(--subtle); 
      font-size: 16px;
      transition: color 0.3s var(--timing-function), transform 0.2s var(--timing-function);
      cursor: pointer;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
    }
    
    .browser-button:hover { 
      color: var(--accent); 
      transform: scale(1.1); 
      background: rgba(59, 130, 246, 0.1);
    }
    
    .browser-content {
      padding: 45px; 
      min-height: 60vh; 
      position: relative;
      background: white; 
      transition: background-color 0.5s var(--timing-function);
      overflow-y: auto; 
      max-height: 70vh;
      scrollbar-width: thin;
      scrollbar-color: var(--subtle) transparent;
    }
    
    .browser-content::-webkit-scrollbar {
      width: 6px;
    }
    
    .browser-content::-webkit-scrollbar-track {
      background: transparent;
    }
    
    .browser-content::-webkit-scrollbar-thumb {
      background-color: var(--subtle);
      border-radius: 6px;
    }
    
    body.dark .browser-content { 
      background: #121218;
    }
    
    .heading {
      font-family: 'Playfair Display', serif; 
      font-weight: 700;
      font-size: 3.75rem; 
      margin-bottom: 28px; 
      line-height: 1.2;
      opacity: 0; 
      transform: translateY(20px);
      transition: opacity 0.8s var(--timing-function) 0.3s, transform 0.8s var(--timing-function) 0.3s;
      text-shadow: var(--text-shadow);
      background: linear-gradient(135deg, var(--primary), #454551);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    body.dark .heading {
      background: linear-gradient(135deg, var(--secondary), #c8c8d0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .heading.active { 
      opacity: 1; 
      transform: translateY(0); 
    }
    
    .subheading {
      font-family: 'Playfair Display', serif; 
      font-weight: 500;
      font-size: 1.625rem; 
      margin-bottom: 18px; 
      color: var(--accent);
      opacity: 0; 
      transform: translateY(20px);
      transition: opacity 0.8s var(--timing-function) 0.5s, transform 0.8s var(--timing-function) 0.5s;
      letter-spacing: 0.01em;
    }
    
    .subheading.active { 
      opacity: 1; 
      transform: translateY(0); 
    }
    
    .paragraph {
      font-size: 1.125rem; 
      line-height: 1.7; 
      margin-bottom: 28px;
      max-width: 800px; 
      opacity: 0; 
      transform: translateY(20px);
      transition: opacity 0.8s var(--timing-function) 0.7s, transform 0.8s var(--timing-function) 0.7s;
      color: rgba(10, 10, 15, 0.8);
    }
    
    body.dark .paragraph {
      color: rgba(247, 247, 249, 0.8);
    }
    
    .paragraph.active { 
      opacity: 1; 
      transform: translateY(0); 
    }
    
    .quote {
      font-family: 'Playfair Display', serif; 
      font-size: 1.5rem;
      font-style: italic; 
      color: var(--accent); 
      margin: 45px 0;
      padding: 20px 30px; 
      border-left: 4px solid var(--accent);
      opacity: 0; 
      transform: translateY(20px);
      transition: opacity 0.8s var(--timing-function) 0.9s, transform 0.8s var(--timing-function) 0.9s;
      background: rgba(59, 130, 246, 0.05);
      border-radius: 0 var(--border-radius) var(--border-radius) 0;
      box-shadow: 0 4px 12px -2px rgba(59, 130, 246, 0.1);
      line-height: 1.6;
    }
    
    body.dark .quote {
      background: rgba(59, 130, 246, 0.1);
      box-shadow: 0 4px 12px -2px rgba(59, 130, 246, 0.2);
    }
    
    .quote.active { 
      opacity: 1; 
      transform: translateY(0); 
    }
    
    .tabs {
      display: flex; 
      border-bottom: 1px solid rgba(0, 0, 0, 0.1); 
      margin: 36px 0;
      opacity: 0; 
      transform: translateY(20px);
      transition: opacity 0.8s var(--timing-function) 0.7s, transform 0.8s var(--timing-function) 0.7s;
      overflow-x: auto;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    
    .tabs::-webkit-scrollbar {
      display: none;
    }
    
    body.dark .tabs { 
      border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
    }
    
    .tabs.active { 
      opacity: 1; 
      transform: translateY(0); 
    }
    
    .tab {
      padding: 14px 28px; 
      font-weight: 500; 
      cursor: pointer;
      position: relative; 
      color: var(--subtle);
      transition: color 0.3s var(--timing-function);
      white-space: nowrap;
    }
    
    .tab:hover { 
      color: var(--accent); 
    }
    
    .tab.active { 
      color: var(--accent); 
    }
    
    .tab.active::after {
      content: ''; 
      position: absolute; 
      bottom: -1px; 
      left: 0;
      width: 100%; 
      height: 2px; 
      background: var(--accent);
      transform: scaleX(0); 
      animation: tab-indicator 0.3s forwards var(--timing-function);
      transform-origin: left;
      border-radius: 2px 2px 0 0;
    }
    
    @keyframes tab-indicator { 
      from { transform: scaleX(0); } 
      to { transform: scaleX(1); } 
    }
    
    .tab-content {
      padding: 36px 0; 
      display: none; 
      animation: fade-in 0.5s var(--timing-function);
    }
    
    .tab-content.active { 
      display: block; 
    }
    
    .blindness-overlay {
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      background: rgba(0, 0, 0, 0); 
      pointer-events: none; 
      z-index: 900;
      transition: background 0.5s ease-out;
      mix-blend-mode: multiply;
    }
    
    .model-grid {
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 24px; 
      margin-top: 36px;
    }
    
    .model-item {
      height: 180px; 
      background: #f5f5f7; 
      border-radius: 12px;
      display: flex; 
      align-items: center; 
      justify-content: center; 
      cursor: pointer;
      transition: transform 0.3s var(--timing-function), box-shadow 0.3s var(--timing-function);
      box-shadow: 0 4px 16px rgba(0,0,0,0.08); 
      position: relative; 
      overflow: hidden;
    }
    
    body.dark .model-item { 
      background: #1a1a22; 
    }
    
    .model-item:hover { 
      transform: translateY(-8px) scale(1.02); 
      box-shadow: 0 12px 24px rgba(0,0,0,0.15); 
    }
    
    .model-item img {
      max-width: 100%; 
      max-height: 100%; 
      object-fit: cover;
      transition: transform 0.5s var(--timing-function);
    }
    
    .model-item:hover img { 
      transform: scale(1.08); 
    }
    
    .model-title {
      position: absolute; 
      bottom: 0; 
      left: 0; 
      right: 0;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0)); 
      color: white; 
      padding: 24px 12px 12px;
      font-size: 0.875rem; 
      text-align: center;
      transform: translateY(100%); 
      transition: transform 0.4s var(--timing-function);
    }
    
    .model-item:hover .model-title { 
      transform: translateY(0); 
    }
    
    .model-game {
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      background: rgba(0, 0, 0, 0.98); 
      z-index: 1000;
      display: none; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center;
      padding: 28px; 
      opacity: 0; 
      transition: opacity 0.5s var(--timing-function);
      backdrop-filter: blur(10px);
    }
    
    .model-game.active { 
      display: flex; 
      opacity: 1; 
      animation: scaleIn 0.4s var(--timing-function);
    }
    
    .game-instructions {
      color: white; 
      font-size: 1.25rem; 
      text-align: center;
      margin-bottom: 36px; 
      max-width: 640px;
      animation: floatIn 0.8s var(--timing-function) forwards;
      opacity: 0;
    }
    
    .game-grid {
      display: grid; 
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px); 
      gap: 16px;
      perspective: 1000px;
    }
    
    .game-cell {
      background: rgba(255,255,255,0.08); 
      border-radius: 12px; 
      cursor: pointer;
      transition: all 0.3s var(--timing-function);
      transform-style: preserve-3d;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.1);
      animation: floatIn 0.6s var(--timing-function) forwards;
      opacity: 0;
    }
    
    .game-cell:nth-child(1) { animation-delay: 0.1s; }
    .game-cell:nth-child(2) { animation-delay: 0.15s; }
    .game-cell:nth-child(3) { animation-delay: 0.2s; }
    .game-cell:nth-child(4) { animation-delay: 0.25s; }
    .game-cell:nth-child(5) { animation-delay: 0.3s; }
    .game-cell:nth-child(6) { animation-delay: 0.35s; }
    .game-cell:nth-child(7) { animation-delay: 0.4s; }
    .game-cell:nth-child(8) { animation-delay: 0.45s; }
    .game-cell:nth-child(9) { animation-delay: 0.5s; }
    
    .game-cell:hover { 
      background: rgba(255,255,255,0.15); 
      transform: translateZ(10px) scale(1.05); 
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }
    
    .game-cell.selected {
      background: var(--accent); 
      animation: pulse-glow 2s infinite;
      box-shadow: 0 0 15px var(--accent), 0 0 30px rgba(59, 130, 246, 0.4);
      border-color: rgba(255,255,255,0.3);
    }
    
    .game-actions { 
      margin-top: 36px; 
      display: flex; 
      gap: 16px;
      animation: floatIn 0.8s var(--timing-function) 0.4s forwards;
      opacity: 0;
    }
    
    .btn {
      padding: 12px 30px; 
      background: var(--accent); 
      color: white; 
      border: none;
      border-radius: 10px; 
      font-size: 1rem; 
      font-weight: 500; 
      cursor: pointer;
      transition: all 0.3s var(--timing-function);
      position: relative; 
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3), 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .btn::before {
      content: ''; 
      position: absolute; 
      top: 0; 
      left: -100%;
      width: 100%; 
      height: 100%; 
      background: rgba(255,255,255,0.2);
      transition: left 0.3s var(--timing-function);
    }
    
    .btn:hover {
      background: var(--accent-hover); 
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4), 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .btn:active {
      transform: translateY(1px);
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }
    
    .btn:hover::before { 
      left: 100%; 
    }
    
    .btn.btn-secondary { 
      background: rgba(255,255,255,0.15); 
      box-shadow: 0 4px 12px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.1);
    }
    
    .btn.btn-secondary:hover { 
      background: rgba(255,255,255,0.25); 
      box-shadow: 0 6px 16px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.2);
    }
    
    .city-model {
      position: relative; 
      margin-top: 54px; 
      background: #f5f5f7;
      border-radius: var(--border-radius); 
      height: 420px; 
      display: flex; 
      align-items: center;
      justify-content: center; 
      overflow: hidden; 
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      transition: transform 0.5s var(--timing-function), box-shadow 0.5s var(--timing-function);
    }
    
    .city-model:hover {
      transform: scale(1.02); 
      box-shadow: 0 16px 48px rgba(0,0,0,0.25);
    }
    
    body.dark .city-model { 
      background: #1a1a22; 
    }
    
    .city-model::before {
      content: ''; 
      position: absolute; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      background: url('https://dnm.nflximg.net/api/v6/2DuQlx0fM4wd1nzqm5BFBi6ILa8/AAAAQUez8BMh95E1QeRI-lCGZ4vWaHLuBs63k5C-VPsjhs_NlPxGfSA_srp1NOaHKeowl-fAJuKDJGfNFh36AKWTGCM1SxwXknpRY8KEzJGtNIs11zsYhRt2MtuDpkTHC8uTrNa5MuLast61FKmBTR4BrwSH.jpg?r=d59');
      background-size: cover; 
      background-position: center; 
      opacity: 0.7;
      transition: opacity 0.6s var(--timing-function), transform 4s var(--timing-function);
      filter: brightness(1.05) contrast(1.1);
    }
    
    .city-model:hover::before {
      opacity: 0.9; 
      transform: scale(1.05);
    }
    
    .memory-grid {
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 28px; 
      margin-top: 36px;
    }
    
    .memory-card {
      height: 280px; 
      border-radius: var(--border-radius); 
      overflow: hidden; 
      position: relative;
      cursor: pointer; 
      transform-style: preserve-3d; 
      transform: perspective(1000px) rotateY(0deg);
      transition: transform 0.7s var(--timing-function); 
      box-shadow: 0 10px 24px rgba(0,0,0,0.12);
    }
    
    .memory-card.flipped { 
      transform: perspective(1000px) rotateY(180deg); 
    }
    
    .memory-card-front,
    .memory-card-back {
      position: absolute; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      backface-visibility: hidden; 
      -webkit-backface-visibility: hidden;
      transition: box-shadow 0.3s var(--timing-function);
    }
    
    .memory-card:hover .memory-card-front,
    .memory-card:hover .memory-card-back {
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    }
    
    .memory-card-front {
      background: linear-gradient(135deg, var(--accent), #1d4ed8);
      display: flex; 
      align-items: center; 
      justify-content: center;
      font-size: 2.25rem; 
      color: white; 
      transform: rotateY(0deg);
      overflow: hidden;
    }
    
    .memory-card-front::after {
      content: '';
      position: absolute;
      width: 150%;
      height: 150%;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
      top: -25%;
      left: -25%;
      opacity: 0;
      transition: opacity 0.5s var(--timing-function);
    }
    
    .memory-card:hover .memory-card-front::after {
      opacity: 1;
    }
    
    .memory-card-back {
      background: white; 
      transform: rotateY(180deg);
      display: flex; 
      align-items: center; 
      justify-content: center; 
      padding: 18px;
    }
    
    body.dark .memory-card-back { 
      background: #1a1a22; 
    }
    
    .memory-card-back img {
      max-width: 100%; 
      max-height: 100%; 
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .memory-title {
      position: absolute; 
      bottom: 0; 
      left: 0; 
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.85), rgba(0,0,0,0.5) 70%, rgba(0,0,0,0)); 
      color: white; 
      padding: 24px 12px 12px;
      font-size: 0.95rem; 
      text-align: center;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }
    
    .canvas-container {
      position: relative; 
      width: 100%; 
      max-width: 600px;
      margin: 0 auto; 
      border-radius: var(--border-radius); 
      overflow: hidden;
      box-shadow: 0 12px 36px rgba(0,0,0,0.15);
    }
    
    #drawingCanvas {
      width: 100%; 
      height: 430px; 
      background: #f5f5f7;
      cursor: crosshair; 
      border-radius: var(--border-radius) var(--border-radius) 0 0; 
      touch-action: none;
      transition: background-color 0.3s var(--timing-function);
    }
    
    body.dark #drawingCanvas { 
      background: #1a1a22; 
    }
    
    .drawing-tools {
      display: flex; 
      align-items: center; 
      justify-content: space-between;
      padding: 16px; 
      background: #f0f0f5; 
      border-radius: 0 0 var(--border-radius) var(--border-radius);
      transition: background-color 0.3s var(--timing-function);
    }
    
    body.dark .drawing-tools { 
      background: #212128; 
    }
    
    .color-picker { 
      display: flex; 
      gap: 10px; 
    }
    
    .color-option {
      width: 26px; 
      height: 26px; 
      border-radius: 50%; 
      cursor: pointer;
      border: 2px solid transparent; 
      transition: all 0.2s var(--timing-function);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .color-option:hover, .color-option.active {
      transform: scale(1.2); 
      border-color: white;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }
    
    .brush-size { 
      width: 130px; 
      -webkit-appearance: none;
      height: 6px;
      background: rgba(0,0,0,0.1);
      border-radius: 3px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      outline: none;
    }
    
    body.dark .brush-size {
      background: rgba(255,255,255,0.1);
    }
    
    .brush-size::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      transition: all 0.2s var(--timing-function);
    }
    
    .brush-size::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      background: var(--accent-hover);
    }
    
    .drawing-actions { 
      display: flex; 
      gap: 10px; 
    }
    
    .drawing-actions button {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s var(--timing-function);
    }
    
    .drawing-actions button:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
    }
    
    .model-score {
      position: fixed; 
      top: 50%; 
      left: 50%;
      transform: translate(-50%, -50%) scale(0); 
      background: rgba(15, 15, 20, 0.95);
      color: white; 
      padding: 45px; 
      border-radius: 24px; 
      text-align: center;
      z-index: 2000; 
      opacity: 0;
      transition: transform 0.5s var(--timing-function), opacity 0.5s var(--timing-function);
      backdrop-filter: blur(8px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.1);
      max-width: 90%;
      width: 360px;
    }
    
    .model-score.active {
      transform: translate(-50%, -50%) scale(1); 
      opacity: 1;
      animation: score-pop 0.5s var(--timing-function);
    }
    
    @keyframes score-pop {
      0% { transform: translate(-50%, -50%) scale(0.8); }
      50% { transform: translate(-50%, -50%) scale(1.1); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }
    
    .score-value {
      font-size: 5.5rem; 
      font-weight: 700; 
      margin: 24px 0;
      font-family: 'Playfair Display', serif;
      background: linear-gradient(135deg, #3b82f6, #60a5fa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1;
      text-shadow: 0 2px 10px rgba(59, 130, 246, 0.4);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes blurIn {
      from { filter: blur(10px); opacity: 0; }
      to { filter: blur(0); opacity: 1; }
    }
    
    @keyframes floatIn {
      0% { transform: translateY(20px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes pulse-glow {
      0% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5), 0 0 10px rgba(59, 130, 246, 0.2); }
      50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8), 0 0 30px rgba(59, 130, 246, 0.4); }
      100% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5), 0 0 10px rgba(59, 130, 246, 0.2); }
    }
    
    @keyframes wiggle {
      0%, 100% { transform: rotate(-3deg); }
      50% { transform: rotate(3deg); }
    }
    
    .fade-in { animation: fadeIn 0.8s var(--timing-function) forwards; opacity: 0; }
    .scale-in { animation: scaleIn 0.8s var(--timing-function) forwards; opacity: 0; }
    .blur-in { animation: blurIn 0.8s var(--timing-function) forwards; opacity: 0; }
    .float-in { animation: floatIn 1s var(--timing-function) forwards; opacity: 0; }
    .pulse-glow { animation: pulse-glow 2s infinite; }
    .wiggle { animation: wiggle 2s infinite; }
    
    .delay-100 { animation-delay: 0.1s; }
    .delay-200 { animation-delay: 0.2s; }
    .delay-300 { animation-delay: 0.3s; }
    .delay-400 { animation-delay: 0.4s; }
    .delay-500 { animation-delay: 0.5s; }
    
    @keyframes content-fade {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    .browser-content-transition { 
      animation: content-fade 0.6s var(--timing-function); 
    }
    
    .section-marker { 
      position: absolute; 
      top: 50%; 
      height: 1px; 
      width: 100%; 
      opacity: 0; 
    }
    
    .tooltip {
      position: absolute; 
      background: rgba(15, 15, 20, 0.9); 
      color: white;
      padding: 12px 18px; 
      border-radius: 10px; 
      font-size: 14px;
      z-index: 1000; 
      pointer-events: none; 
      opacity: 0;
      transition: opacity 0.3s var(--timing-function), transform 0.3s var(--timing-function);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.1);
      transform: translateY(5px);
      backdrop-filter: blur(4px);
    }
    
    .tooltip.active { 
      opacity: 1; 
      transform: translateY(0);
    }
    
    .tooltip::after {
      content: ''; 
      position: absolute; 
      bottom: -8px; 
      left: 50%;
      transform: translateX(-50%);
      border-width: 8px 8px 0; 
      border-style: solid;
      border-color: rgba(15, 15, 20, 0.9) transparent transparent;
    }
    
    @media (max-width: 1200px) {
      .sticky-browser { width: 92%; }
      .browser-content { padding: 36px; }
      .heading { font-size: 3.25rem; }
    }
    
    @media (max-width: 768px) {
      .heading { font-size: 2.75rem; }
      .quote { font-size: 1.25rem; padding: 15px 24px; margin: 36px 0; }
      .browser-content { padding: 24px; max-height: 65vh; }
      .browser-frame:hover { transform: none; }
      .game-grid {
        grid-template-columns: repeat(3, 80px); 
        grid-template-rows: repeat(3, 80px);
        gap: 12px;
      }
      .model-grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
      .browser-header { padding: 12px 16px; }
    }
    
    @media (max-width: 480px) {
      .heading { font-size: 2.25rem; }
      .subheading { font-size: 1.375rem; }
      .paragraph { font-size: 1rem; }
      .browser-header { padding: 10px 12px; }
      .browser-dots { gap: 6px; }
      .browser-dot { width: 10px; height: 10px; }
      .browser-address { margin: 0 8px; padding: 6px 10px; font-size: 12px; }
      .browser-content { padding: 20px; max-height: 60vh; }
      .game-grid {
        grid-template-columns: repeat(3, 70px); 
        grid-template-rows: repeat(3, 70px); 
        gap: 8px;
      }
      .tab { padding: 10px 14px; font-size: 0.875rem; }
      .memory-grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
      .model-score { padding: 30px; width: 320px; }
      .score-value { font-size: 4.5rem; }
    }
  </style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div class="blindness-overlay" id="blindnessOverlay"></div>
  <div class="sticky-browser" id="stickyBrowser">
    <div class="browser-frame">
      <div class="browser-header">
        <div class="browser-dots">
          <div class="browser-dot red"></div>
          <div class="browser-dot yellow"></div>
          <div class="browser-dot green"></div>
        </div>
        <div class="browser-address" id="browserAddress">marie-laure.worldview.com</div>
        <div class="browser-buttons">
          <div class="browser-button"><i class="fa-solid fa-share"></i></div>
          <div class="browser-button"><i class="fa-solid fa-bookmark"></i></div>
        </div>
      </div>
      <div class="browser-content" id="browserContent">
        <div class="browser-content-transition">
          <h2 class="subheading active">All the Light We Cannot See</h2>
          <h1 class="heading active">See the World Like Marie-Laure</h1>
          <p class="paragraph active">Welcome to a fun, interactive look at the life of Marie-Laure, a girl who lost her sight. Scroll down to explore her world of light and dark.</p>
          <blockquote class="quote active">"Look with your eyes while you still can." <br>― Anthony Doerr, All the Light We Cannot See</blockquote>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <section id="intro" data-address="marie-laure.worldview.com" data-title="See the World Like Marie-Laure">
      <div class="section-marker" data-section="intro"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="sight" data-address="marie-laure.memories.com" data-title="The Last Pictures She Saw">
      <div class="section-marker" data-section="sight"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="blindness" data-address="marie-laure.darkness.com" data-title="Losing Her Sight">
      <div class="section-marker" data-section="blindness"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="adaptation" data-address="marie-laure.senses.com" data-title="Learning to Feel the World">
      <div class="section-marker" data-section="adaptation"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="drawingGame" data-address="marie-laure.touch.com" data-title="Draw Your Own Model">
      <div class="section-marker" data-section="drawingGame"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="game" data-address="marie-laure.experience.com" data-title="Remember the Pattern">
      <div class="section-marker" data-section="game"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="radio" data-address="marie-laure.broadcasts.com" data-title="Radio Broadcasts">
      <div class="section-marker" data-section="radio"></div>
      <div style="height: 70vh"></div>
    </section>
    <section id="ending" data-address="marie-laure.legacy.com" data-title="Marie-Laure's Legacy">
      <div class="section-marker" data-section="ending"></div>
      <div style="height: 70vh"></div>
    </section>
  </div>
  <div class="model-game" id="modelGame">
    <div class="game-instructions">
      <h2 style="margin-bottom: 16px; font-size: 1.75rem;">Level 1: Remember the Pattern</h2>
      <p>Look at the lit squares. They will go away, and you must copy the pattern from memory.</p>
    </div>
    <div class="game-grid" id="gameGrid">
      <div class="game-cell" data-index="0"></div>
      <div class="game-cell" data-index="1"></div>
      <div class="game-cell" data-index="2"></div>
      <div class="game-cell" data-index="3"></div>
      <div class="game-cell" data-index="4"></div>
      <div class="game-cell" data-index="5"></div>
      <div class="game-cell" data-index="6"></div>
      <div class="game-cell" data-index="7"></div>
      <div class="game-cell" data-index="8"></div>
    </div>
    <div class="game-actions">
      <button id="checkPatternBtn" class="btn" style="display: none;">Check Pattern</button>
      <button id="closeGameBtn" class="btn btn-secondary">Close</button>
    </div>
  </div>
  <div class="model-score" id="modelScore">
    <h2>Your Drawing Score</h2>
    <div class="score-value">85%</div>
    <p>Great job! You copied most of the details.</p>
    <button id="closeScoreBtn" class="btn">Continue</button>
  </div>
  <div class="tooltip" id="tutorial"></div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const sectionData = {
        intro: {
          title: "See the World Like Marie-Laure",
          content: `
            <h2 class="subheading">All the Light We Cannot See</h2>
            <h1 class="heading">See the World Like Marie-Laure</h1>
            <p class="paragraph">Welcome to a fun, interactive look at the life of Marie-Laure, a girl who lost her sight. Scroll down to explore her world of light and dark.</p>
            <blockquote class="quote">"Look with your eyes while you still can." <br>― Anthony Doerr, All the Light We Cannot See</blockquote>
            <div class="tabs">
              <div class="tab active" data-tab="biography">Biography</div>
              <div class="tab" data-tab="paris">Paris</div>
              <div class="tab" data-tab="models">Papa's Models</div>
            </div>
            <div class="tab-content active" id="biography">
              <p class="paragraph">Marie-Laure lost her sight when she was six. Her father, a skilled locksmith at the Natural History Museum in Paris, made a small model of their neighborhood so she could learn it by touch and find her way.</p>
              <p class="paragraph">As she grew up, her father helped her use her other senses. He read to her in braille and taught her to be independent.</p>
            </div>
            <div class="tab-content" id="paris">
              <p class="paragraph">Paris in the 1930s was full of life and light. Marie-Laure first saw the city, then learned it by feeling the detailed models her father made.</p>
              <p class="paragraph">Every street and corner was made in a small scale, so she could remember it and find her way.</p>
            </div>
            <div class="tab-content" id="models">
              <p class="paragraph">Her father made very detailed small models of their neighborhood for Marie-Laure.</p>
              <p class="paragraph">These models showed every small detail, like storm drains and park benches. They helped her see the world in a new way.</p>
              <div class="model-grid">
                <div class="model-item">
                  <img src="https://dnm.nflximg.net/api/v6/2DuQlx0fM4wd1nzqm5BFBi6ILa8/AAAAQUez8BMh95E1QeRI-lCGZ4vWaHLuBs63k5C-VPsjhs_NlPxGfSA_srp1NOaHKeowl-fAJuKDJGfNFh36AKWTGCM1SxwXknpRY8KEzJGtNIs11zsYhRt2MtuDpkTHC8uTrNa5MuLast61FKmBTR4BrwSH.jpg?r=d59" alt="Model of Saint-Malo">
                  <div class="model-title">Saint-Malo Model</div>
                </div>
                <div class="model-item">
                  <i class="fa-solid fa-building fa-3x" style="color: #8e8e93;"></i>
                  <div class="model-title">Paris Streets</div>
                </div>
                <div class="model-item">
                  <i class="fa-solid fa-house fa-3x" style="color: #8e8e93;"></i>
                  <div class="model-title">Their Home</div>
                </div>
                <div class="model-item">
                  <i class="fa-solid fa-tree fa-3x" style="color: #8e8e93;"></i>
                  <div class="model-title">Garden Area</div>
                </div>
              </div>
            </div>
          `
        },
        sight: {
          title: "The Last Pictures She Saw",
          content: `
            <h2 class="subheading">Old Memories</h2>
            <h1 class="heading">The Last Pictures She Saw</h1>
            <p class="paragraph">Before she lost her sight, Marie-Laure saw the world in bright colors and shapes. She remembers the blue sky, green trees, and the details of the museum where her father worked.</p>
            <blockquote class="quote">"When I lost my sight, people called me brave. But I had no choice. I wake up and live my life. Do you do the same?"</blockquote>
            <div class="memory-grid">
              <div class="memory-card">
                <div class="memory-card-front">
                  <i class="fa-solid fa-museum"></i>
                </div>
                <div class="memory-card-back">
                  <img src="https://dnm.nflximg.net/api/v6/2DuQlx0fM4wd1nzqm5BFBi6ILa8/AAAAQUez8BMh95E1QeRI-lCGZ4vWaHLuBs63k5C-VPsjhs_NlPxGfSA_srp1NOaHKeowl-fAJuKDJGfNFh36AKWTGCM1SxwXknpRY8KEzJGtNIs11zsYhRt2MtuDpkTHC8uTrNa5MuLast61FKmBTR4BrwSH.jpg?r=d59" alt="Paris Streets">
                  <div class="memory-title">Paris Streets</div>
                </div>
              </div>
              <div class="memory-card">
                <div class="memory-card-front">
                  <i class="fa-solid fa-diamond"></i>
                </div>
                <div class="memory-card-back">
                  <i class="fa-solid fa-landmark fa-4x" style="color: #8e8e93;"></i>
                  <div class="memory-title">Museum</div>
                </div>
              </div>
              <div class="memory-card">
                <div class="memory-card-front">
                  <i class="fa-solid fa-diamond"></i>
                </div>
                <div class="memory-card-back">
                  <i class="fa-solid fa-person fa-4x" style="color: #8e8e93;"></i>
                  <div class="memory-title">Her Father</div>
                </div>
              </div>
              <div class="memory-card">
                <div class="memory-card-front">
                  <i class="fa-solid fa-museum"></i>
                </div>
                <div class="memory-card-back">
                  <i class="fa-solid fa-book fa-4x" style="color: #8e8e93;"></i>
                  <div class="memory-title">Books</div>
                </div>
              </div>
            </div>
          `
        },
        blindness: {
          title: "Losing Her Sight",
          content: `
            <h2 class="subheading">Darkness Falls</h2>
            <h1 class="heading">Losing Her Sight</h1>
            <p class="paragraph">When she was six, Marie-Laure's world went dark. Doctors said it was cataracts, a fast type of eye problem. She described it as "black snow."</p>
            <blockquote class="quote">"Closing your eyes means you miss the world." </blockquote>
            <p class="paragraph">Keep scrolling to feel what Marie-Laure felt in a world without sight, where other senses take over.</p>
          `
        },
        adaptation: {
          title: "Learning to Feel the World",
          content: `
            <h2 class="subheading">A New Way to See</h2>
            <h1 class="heading">Learning to Feel the World</h1>
            <p class="paragraph">After she lost her sight, Marie-Laure learned to use her other senses. Her father made detailed wooden models of their Paris neighborhood to help her learn the layout.</p>
            <p class="paragraph">These models were like a map that she could feel and remember to move around safely.</p>
            <blockquote class="quote">"We call light 'color', but light itself is invisible." </blockquote>
            <h3 style="font-size: 1.5rem; font-weight: 600; margin: 32px 0 16px;">The Saint-Malo Model</h3>
            <p class="paragraph">When Marie-Laure and her father went to Saint-Malo to escape the war, he made a new model of the city. It helped her learn a new place.</p>
            <div class="city-model"></div>
          `
        },
        drawingGame: {
          title: "Draw Your Own Model",
          content: `
            <h2 class="subheading">Feel What She Felt</h2>
            <h1 class="heading">Draw Your Own Model</h1>
            <p class="paragraph">Now it's your turn. Marie-Laure learned by touching her father's models. Try to draw the model of Saint-Malo as best as you can. Look at the picture, then draw it from memory.</p>
            <div style="text-align: center; margin-bottom: 24px;">
              <button id="showReferenceBtn" class="btn pulse-glow">View Reference Model</button>
              <button id="startDrawingBtn" class="btn" style="display: none;">Start Drawing</button>
            </div>
            <div id="referenceImage" style="display: none; margin-bottom: 24px; text-align: center;">
              <img src="https://dnm.nflximg.net/api/v6/2DuQlx0fM4wd1nzqm5BFBi6ILa8/AAAAQUez8BMh95E1QeRI-lCGZ4vWaHLuBs63k5C-VPsjhs_NlPxGfSA_srp1NOaHKeowl-fAJuKDJGfNFh36AKWTGCM1SxwXknpRY8KEzJGtNIs11zsYhRt2MtuDpkTHC8uTrNa5MuLast61FKmBTR4BrwSH.jpg?r=d59" alt="Saint-Malo Model" style="max-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
              <p style="margin-top: 12px; font-style: italic;">Look at this model closely. It will disappear soon, and then you will draw it from memory.</p>
            </div>
            <div class="canvas-container" id="canvasContainer" style="display: none;">
              <canvas id="drawingCanvas" width="600" height="400"></canvas>
              <div class="drawing-tools">
                <div class="color-picker">
                  <div class="color-option active" style="background-color: #000000;" data-color="#000000"></div>
                  <div class="color-option" style="background-color: #4285F4;" data-color="#4285F4"></div>
                  <div class="color-option" style="background-color: #EA4335;" data-color="#EA4335"></div>
                  <div class="color-option" style="background-color: #FBBC05;" data-color="#FBBC05"></div>
                  <div class="color-option" style="background-color: #34A853;" data-color="#34A853"></div>
                </div>
                <input type="range" min="1" max="20" value="3" class="brush-size" id="brushSize">
                <div class="drawing-actions">
                  <button id="clearCanvas" class="btn btn-secondary"><i class="fa-solid fa-trash"></i></button>
                  <button id="submitDrawing" class="btn">Submit</button>
                </div>
              </div>
            </div>
            <blockquote class="quote">"But Papa, how did you make the houses look so real? How did you make them seem to lean in a little?"</blockquote>
          `
        },
        game: {
          title: "Remember the Pattern",
          content: `
            <h2 class="subheading">Try It Out</h2>
            <h1 class="heading">Remember the Pattern</h1>
            <p class="paragraph">Now it's your turn to try what Marie-Laure did. You will see a pattern for a short time, and then it will go away. Try to recreate it from memory, just like she remembered her father's models.</p>
            <p class="paragraph">Click the button to start:</p>
            <button id="startGameBtn" class="btn pulse-glow">Start Memory Challenge</button>
            <blockquote class="quote">"She moves with grace, like a dancer in soft shoes."</blockquote>
          `
        },
        radio: {
          title: "Radio Broadcasts",
          content: `
            <h2 class="subheading">The Sound of Life</h2>
            <h1 class="heading">Radio Broadcasts</h1>
            <p class="paragraph">For Marie-Laure, sound was very important. In Saint-Malo, she found her great-uncle's radio and loved the broadcasts on it.</p>
            <p class="paragraph">During the war, radio played a big part as she listened to secret messages and helped the resistance.</p>
            <div style="margin: 40px 0; padding: 24px; background: rgba(0,102,204,0.1); border-radius: 12px; border-left: 4px solid var(--accent);" class="pulse-glow">
              <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 16px; color: var(--accent);">
                <i class="fa-solid fa-radio" style="margin-right: 8px;"></i> Broadcast: Under the Sea
              </h3>
              <p style="font-style: italic; margin-bottom: 16px;" class="wiggle">"The mountains or forts looked so tall, they could not be climbed or entered..."</p>
              <p style="font-size: 0.875rem; color: var(--subtle);">Marie-Laure sent secret messages from a small attic.</p>
            </div>
            <blockquote class="quote">"Radio connects many ears to one voice."</blockquote>
          `
        },
        ending: {
          title: "Marie-Laure's Legacy",
          content: `
            <h2 class="subheading">The Light We Cannot See</h2>
            <h1 class="heading">Marie-Laure's Legacy</h1>
            <p class="paragraph">Marie-Laure's story shows us that there are many ways to see. Even though she lost her sight, she learned more about life using her other senses and her mind.</p>
            <p class="paragraph">In the book, she survives the war and becomes a scientist who studies sea creatures, keeping her bond with nature from her early days at the museum.</p>
            <blockquote class="quote">"We all start as a tiny cell, even smaller than a speck of dust. Then we grow and change until we become who we are."</blockquote>
            <div style="margin-top: 40px; text-align: center;">
              <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 24px;">Thank You for Trying "All the Light We Cannot See"</h3>
              <p class="paragraph" style="text-align: center;">This interactive experience was made by Mirko. Thanks for playing!</p>
            </div>
          `
        }
      };
      const progressBar = document.getElementById('progressBar');
      const blindnessOverlay = document.getElementById('blindnessOverlay');
      const browserAddress = document.getElementById('browserAddress');
      const browserContent = document.getElementById('browserContent');
      const stickyBrowser = document.getElementById('stickyBrowser');
      const sections = document.querySelectorAll('section');
      const sectionMarkers = document.querySelectorAll('.section-marker');
      const tutorial = document.getElementById('tutorial');
      let lastScrollTop = 0;
      let ticking = false;
      let currentSection = 'intro';
      let activeSections = ['intro'];
      let isFirstVisit = true;
      let lastMouseX = window.innerWidth / 2;
      let lastMouseY = window.innerHeight / 2;
      let spotlightActive = false;
      updateBrowserContent('intro');
      if (isFirstVisit) {
        showTutorial('Scroll down to explore Marie-Laure\'s story', document.body, 'bottom');
        setTimeout(() => hideTutorial(), 5000);
      }
      function handleScroll() {
        const scrollTop = window.scrollY;
        const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrollProgress = (scrollTop / height) * 100;
        progressBar.style.width = scrollProgress + "%";
        const parallaxOffset = Math.min(Math.max((scrollTop / height) * 30 - 15, -15), 15);
        const scaleFactor = 1 - Math.abs(parallaxOffset) / 100;
        stickyBrowser.style.transform = `translate(-50%, calc(-50% + ${parallaxOffset}px)) scale(${scaleFactor})`;
        if (scrollProgress > 30 && scrollProgress < 60) {
          const blindnessIntensity = Math.min((scrollProgress - 30) / 20, 1) * 0.9;
          if (!spotlightActive) { document.addEventListener('mousemove', spotlightHandler); spotlightActive = true; }
          spotlightHandler({ clientX: lastMouseX, clientY: lastMouseY, intensity: blindnessIntensity });
          if (scrollProgress > 40) { document.body.classList.add('dark'); } else { document.body.classList.remove('dark'); }
        } else if (scrollProgress <= 30) {
          if (spotlightActive) { document.removeEventListener('mousemove', spotlightHandler); spotlightActive = false; }
          blindnessOverlay.style.background = 'rgba(0,0,0,0)';
          document.body.classList.remove('dark');
        }
        determineCurrentSection();
        lastScrollTop = scrollTop;
        ticking = false;
      }
      function spotlightHandler(e) {
        lastMouseX = e.clientX;
        lastMouseY = e.clientY;
        const intensity = e.intensity !== undefined ? e.intensity : 0.9;
        blindnessOverlay.style.background = `radial-gradient(circle at ${e.clientX}px ${e.clientY}px, transparent 55px, rgba(0,0,0,0.99) 75px)`;
      }
      function determineCurrentSection() {
        let newCurrentSection = currentSection;
        sectionMarkers.forEach(marker => {
          const rect = marker.getBoundingClientRect();
          if (rect.top >= -window.innerHeight * 0.3 && rect.top <= window.innerHeight * 0.7) {
            newCurrentSection = marker.getAttribute('data-section');
          }
        });
        if (newCurrentSection !== currentSection) {
          currentSection = newCurrentSection;
          updateBrowserContent(currentSection);
          const newAddress = document.querySelector(`section[id="${currentSection}"]`).getAttribute('data-address');
          animateAddressChange(newAddress);
          if (!activeSections.includes(currentSection)) {
            activeSections.push(currentSection);
            if (currentSection === 'drawingGame') {
              setTimeout(() => {
                showTutorial('Click "View Reference Model" to start the drawing game', document.getElementById('showReferenceBtn'), 'top');
                setTimeout(() => hideTutorial(), 5000);
              }, 1000);
            }
            if (currentSection === 'game') {
              setTimeout(() => {
                showTutorial('Test your memory like Marie-Laure did', document.getElementById('startGameBtn'), 'top');
                setTimeout(() => hideTutorial(), 5000);
              }, 1000);
            }
          }
        }
      }
      function updateBrowserContent(sectionId) {
        const section = sectionData[sectionId];
        if (!section) return;
        const contentWrapper = document.createElement('div');
        contentWrapper.className = 'browser-content-transition';
        contentWrapper.innerHTML = section.content;
        browserContent.innerHTML = '';
        browserContent.appendChild(contentWrapper);
        setTimeout(() => {
          activateElements(browserContent);
          attachEventListeners();
        }, 100);
      }
      function animateAddressChange(newAddress) {
        browserAddress.classList.add('wiggle');
        browserAddress.style.opacity = '0';
        setTimeout(() => {
          browserAddress.textContent = newAddress;
          browserAddress.style.opacity = '1';
          setTimeout(() => { browserAddress.classList.remove('wiggle'); }, 1000);
        }, 300);
      }
      function activateElements(container) {
        const elements = container.querySelectorAll('.heading, .subheading, .paragraph, .quote, .tabs');
        elements.forEach(el => el.classList.add('active'));
      }
      function attachEventListeners() {
        document.querySelectorAll('.tab').forEach(tab => {
          tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');
            document.querySelectorAll('.tab-content').forEach(content => { content.classList.remove('active'); });
            document.querySelectorAll('.tab').forEach(t => { t.classList.remove('active'); });
            this.classList.add('active');
            document.getElementById(tabId).classList.add('active');
          });
        });
        document.querySelectorAll('.memory-card').forEach(card => {
          card.addEventListener('click', function() { this.classList.toggle('flipped'); });
        });
        const showReferenceBtn = document.getElementById('showReferenceBtn');
        const startDrawingBtn = document.getElementById('startDrawingBtn');
        if (showReferenceBtn && startDrawingBtn) { setupDrawingGame(); }
        const startGameBtn = document.getElementById('startGameBtn');
        if (startGameBtn) {
          startGameBtn.addEventListener('click', function() {
            document.getElementById('modelGame').classList.add('active');
            startMemoryGame();
          });
        }
      }
      function setupDrawingGame() {
        const showReferenceBtn = document.getElementById('showReferenceBtn');
        const startDrawingBtn = document.getElementById('startDrawingBtn');
        const referenceImage = document.getElementById('referenceImage');
        const canvasContainer = document.getElementById('canvasContainer');
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        const clearCanvasBtn = document.getElementById('clearCanvas');
        const submitDrawingBtn = document.getElementById('submitDrawing');
        const colorOptions = document.querySelectorAll('.color-option');
        const brushSize = document.getElementById('brushSize');
        const modelScore = document.getElementById('modelScore');
        const closeScoreBtn = document.getElementById('closeScoreBtn');
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let currentColor = '#000000';
        let currentBrushSize = 3;
        showReferenceBtn.addEventListener('click', function() {
          referenceImage.style.display = 'block';
          showReferenceBtn.style.display = 'none';
          startDrawingBtn.style.display = 'inline-block';
          setTimeout(() => {
            if (referenceImage.style.display === 'block') {
              referenceImage.style.display = 'none';
              startDrawingBtn.click();
            }
          }, 10000);
          showTutorial('Look at this model closely! It will disappear in 10 seconds', referenceImage, 'top');
          setTimeout(() => hideTutorial(), 4000);
        });
        startDrawingBtn.addEventListener('click', function() {
          referenceImage.style.display = 'none';
          canvasContainer.style.display = 'block';
          startDrawingBtn.style.display = 'none';
          resizeCanvas();
          ctx.lineCap = 'round';
          ctx.lineJoin = 'round';
          ctx.strokeStyle = currentColor;
          ctx.lineWidth = currentBrushSize;
          showTutorial('Draw the model from memory as best you can', canvas, 'top');
          setTimeout(() => hideTutorial(), 4000);
        });
        function resizeCanvas() {
          const containerWidth = canvasContainer.offsetWidth;
          canvas.width = containerWidth;
          canvas.height = (containerWidth * 2) / 3;
          ctx.lineCap = 'round';
          ctx.lineJoin = 'round';
          ctx.strokeStyle = currentColor;
          ctx.lineWidth = currentBrushSize;
        }
        window.addEventListener('resize', resizeCanvas);
        function startDrawingStroke(e) {
          isDrawing = true;
          const coords = getCoordinates(e);
          lastX = coords.x;
          lastY = coords.y;
        }
        function drawStroke(e) {
          if (!isDrawing) return;
          const coords = getCoordinates(e);
          ctx.beginPath();
          ctx.moveTo(lastX, lastY);
          ctx.lineTo(coords.x, coords.y);
          ctx.stroke();
          lastX = coords.x;
          lastY = coords.y;
        }
        function endDrawingStroke() { isDrawing = false; }
        function getCoordinates(e) {
          let x, y;
          if (e.type.includes('touch')) {
            x = e.touches[0].clientX - canvas.getBoundingClientRect().left;
            y = e.touches[0].clientY - canvas.getBoundingClientRect().top;
          } else { x = e.offsetX; y = e.offsetY; }
          return { x, y };
        }
        canvas.addEventListener('mousedown', startDrawingStroke);
        canvas.addEventListener('mousemove', drawStroke);
        canvas.addEventListener('mouseup', endDrawingStroke);
        canvas.addEventListener('mouseout', endDrawingStroke);
        canvas.addEventListener('touchstart', function(e) { e.preventDefault(); startDrawingStroke(e); });
        canvas.addEventListener('touchmove', function(e) { e.preventDefault(); drawStroke(e); });
        canvas.addEventListener('touchend', endDrawingStroke);
        colorOptions.forEach(option => {
          option.addEventListener('click', function() {
            colorOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            currentColor = this.getAttribute('data-color');
            ctx.strokeStyle = currentColor;
          });
        });
        brushSize.addEventListener('input', function() {
          currentBrushSize = this.value;
          ctx.lineWidth = currentBrushSize;
        });
        clearCanvasBtn.addEventListener('click', function() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        });
        submitDrawingBtn.addEventListener('click', function() {
          const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
          const data = imageData.data;
          let nonEmptyPixels = 0;
          for (let i = 0; i < data.length; i += 4) {
            if (data[i + 3] > 0) { nonEmptyPixels++; }
          }
          const complexityPercentage = Math.min(nonEmptyPixels / (canvas.width * canvas.height * 0.05), 1);
          const baseScore = 70;
          const score = Math.round(baseScore + (complexityPercentage * 25));
          document.querySelector('.score-value').textContent = score + '%';
          let message;
          if (score >= 90) { message = "Excellent! Your drawing copied the model perfectly!"; }
          else if (score >= 80) { message = "Great job! You copied most of the details."; }
          else { message = "Good try! With practice, you'll notice more details."; }
          document.querySelector('#modelScore p').textContent = message;
          modelScore.classList.add('active');
          canvasContainer.style.display = 'none';
        });
        closeScoreBtn.addEventListener('click', function() { modelScore.classList.remove('active'); });
      }
      function startMemoryGame() {
        const modelGame = document.getElementById('modelGame');
        const closeGameBtn = document.getElementById('closeGameBtn');
        const checkPatternBtn = document.getElementById('checkPatternBtn');
        const gameGrid = document.getElementById('gameGrid');
        const gameCells = document.querySelectorAll('.game-cell');
        let pattern = [];
        let userPattern = [];
        let gameState = 'inactive';
        let gameLevel = 1;
        let correctAnswers = 0;
        closeGameBtn.addEventListener('click', function() {
          modelGame.classList.remove('active');
          resetGame();
        });
        gameState = 'showing';
        pattern = generateRandomPattern(gameLevel);
        userPattern = [];
        document.querySelector('.game-instructions').innerHTML = `
          <h2 style="margin-bottom: 16px; font-size: 1.75rem;">Level ${gameLevel}: Remember the Pattern</h2>
          <p>Look at the lit squares. They will go away, and you must copy the pattern from memory.</p>
          <p style="margin-top: 8px; font-size: 0.875rem; color: rgba(255,255,255,0.7);">This is like how Marie-Laure learned her father's models by touch.</p>
        `;
        setTimeout(() => {
          pattern.forEach((index, i) => {
            setTimeout(() => { gameCells[index].classList.add('selected'); }, i * 600);
            setTimeout(() => { gameCells[index].classList.remove('selected'); }, (i * 600) + 500);
          });
          setTimeout(() => {
            gameState = 'selecting';
            checkPatternBtn.style.display = 'block';
            document.querySelector('.game-instructions').innerHTML = `
              <h2 style="margin-bottom: 16px; font-size: 1.75rem;">Level ${gameLevel}: Copy the Pattern</h2>
              <p>Click on the squares to copy the pattern you just saw.</p>
              <p style="margin-top: 8px; font-size: 0.875rem; color: rgba(255,255,255,0.7);">Your score: ${correctAnswers} correct</p>
            `;
          }, (pattern.length * 600) + 1000);
        }, 1500);
        gameCells.forEach(cell => {
          cell.addEventListener('click', function() {
            if (gameState !== 'selecting') return;
            const index = parseInt(this.getAttribute('data-index'));
            if (this.classList.contains('selected')) {
              this.classList.remove('selected');
              userPattern = userPattern.filter(i => i !== index);
            } else {
              this.classList.add('selected');
              userPattern.push(index);
            }
          });
        });
        checkPatternBtn.addEventListener('click', function() {
          if (gameState !== 'selecting') return;
          const correct = comparePatterns(pattern, userPattern);
          if (correct) {
            correctAnswers++;
            gameLevel++;
            document.querySelector('.game-instructions').innerHTML = `
              <h2 style="margin-bottom: 16px; font-size: 1.75rem; color: #34c759;">Correct!</h2>
              <p>Great job! You are learning to remember like Marie-Laure did.</p>
              <p style="margin-top: 16px;">Get ready for level ${gameLevel}...</p>
            `;
            gameCells.forEach(cell => {
              cell.style.animation = 'pulseGlow 0.5s';
              setTimeout(() => { cell.style.animation = ''; }, 500);
            });
            setTimeout(() => { resetGameGrid(); startNextLevel(); }, 3000);
          } else {
            document.querySelector('.game-instructions').innerHTML = `
              <h2 style="margin-bottom: 16px; font-size: 1.75rem; color: #ff3b30;">Not Quite Right</h2>
              <p>This is how Marie-Laure felt when learning a new route - it takes practice!</p>
              <p style="margin-top: 16px;">Let's see the correct pattern...</p>
            `;
            setTimeout(() => {
              resetGameGrid();
              pattern.forEach(index => {
                gameCells[index].classList.add('selected');
                gameCells[index].style.backgroundColor = '#34c759';
              });
              setTimeout(() => { resetGameGrid(); startNextLevel(); }, 2000);
            }, 1500);
          }
        });
        function startNextLevel() {
          gameState = 'showing';
          pattern = generateRandomPattern(gameLevel);
          userPattern = [];
          document.querySelector('.game-instructions').innerHTML = `
            <h2 style="margin-bottom: 16px; font-size: 1.75rem;">Level ${gameLevel}: Remember the Pattern</h2>
            <p>Look at the lit squares. They will go away, and you must copy the pattern from memory.</p>
            <p style="margin-top: 8px; font-size: 0.875rem; color: rgba(255,255,255,0.7);">Your score: ${correctAnswers} correct</p>
          `;
          checkPatternBtn.style.display = 'none';
          pattern.forEach((index, i) => {
            setTimeout(() => { gameCells[index].classList.add('selected'); }, i * 600);
            setTimeout(() => { gameCells[index].classList.remove('selected'); }, (i * 600) + 500);
          });
          setTimeout(() => {
            gameState = 'selecting';
            checkPatternBtn.style.display = 'block';
            document.querySelector('.game-instructions').innerHTML = `
              <h2 style="margin-bottom: 16px; font-size: 1.75rem;">Level ${gameLevel}: Copy the Pattern</h2>
              <p>Click on the squares to copy the pattern you just saw.</p>
              <p style="margin-top: 8px; font-size: 0.875rem; color: rgba(255,255,255,0.7);">Your score: ${correctAnswers} correct</p>
            `;
          }, (pattern.length * 600) + 1000);
        }
        function generateRandomPattern(level) {
          const patternLength = Math.min(3 + Math.floor(level / 2), 7);
          const pattern = [];
          while (pattern.length < patternLength) {
            const randomIndex = Math.floor(Math.random() * 9);
            if (!pattern.includes(randomIndex)) { pattern.push(randomIndex); }
          }
          return pattern;
        }
        function comparePatterns(pattern1, pattern2) {
          if (pattern1.length !== pattern2.length) return false;
          const sorted1 = [...pattern1].sort((a, b) => a - b);
          const sorted2 = [...pattern2].sort((a, b) => a - b);
          return sorted1.every((value, index) => value === sorted2[index]);
        }
        function resetGameGrid() {
          gameCells.forEach(cell => {
            cell.classList.remove('selected');
            cell.style.backgroundColor = '';
          });
          userPattern = [];
        }
        function resetGame() {
          gameState = 'inactive';
          pattern = [];
          userPattern = [];
          checkPatternBtn.style.display = 'none';
          resetGameGrid();
          document.querySelector('.game-instructions').innerHTML = `
            <h2 style="margin-bottom: 16px; font-size: 1.75rem;">Remember the Pattern</h2>
            <p>Look at the lit squares. They will go away, and you must copy the pattern from memory.</p>
          `;
        }
      }
      function showTutorial(message, targetElement, position) {
        if (!targetElement) return;
        const tooltip = document.getElementById('tutorial');
        tooltip.textContent = message;
        tooltip.classList.add('active');
        const targetRect = targetElement.getBoundingClientRect();
        let top, left;
        switch(position) {
          case 'top':
            top = targetRect.top - tooltip.offsetHeight - 10;
            left = targetRect.left + (targetRect.width / 2) - (tooltip.offsetWidth / 2);
            break;
          case 'bottom':
            top = targetRect.bottom + 10;
            left = targetRect.left + (targetRect.width / 2) - (tooltip.offsetWidth / 2);
            break;
          case 'left':
            top = targetRect.top + (targetRect.height / 2) - (tooltip.offsetHeight / 2);
            left = targetRect.left - tooltip.offsetWidth - 10;
            break;
          case 'right':
            top = targetRect.top + (targetRect.height / 2) - (tooltip.offsetHeight / 2);
            left = targetRect.right + 10;
            break;
          default:
            top = targetRect.top - tooltip.offsetHeight - 10;
            left = targetRect.left + (targetRect.width / 2) - (tooltip.offsetWidth / 2);
        }
        if (left < 10) left = 10;
        if (left + tooltip.offsetWidth > window.innerWidth - 10) { left = window.innerWidth - tooltip.offsetWidth - 10; }
        if (top < 10) top = targetRect.bottom + 10;
        if (top + tooltip.offsetHeight > window.innerHeight - 10) { top = targetRect.top - tooltip.offsetHeight - 10; }
        tooltip.style.top = `${top}px`;
        tooltip.style.left = `${left}px`;
      }
      function hideTutorial() { document.getElementById('tutorial').classList.remove('active'); }
      // Add this snippet at the end of the DOMContentLoaded callback, before its closing "});"

const toggleBlindnessBtn = document.createElement('button');
toggleBlindnessBtn.textContent = 'Turn Blindness Off (Boring!!)';
toggleBlindnessBtn.style.position = 'fixed';
toggleBlindnessBtn.style.bottom = '20px';
toggleBlindnessBtn.style.right = '20px';
toggleBlindnessBtn.style.zIndex = '3000';
toggleBlindnessBtn.style.padding = '10px';
toggleBlindnessBtn.style.background = 'var(--accent)';
toggleBlindnessBtn.style.color = '#fff';
toggleBlindnessBtn.style.border = 'none';
toggleBlindnessBtn.style.borderRadius = '8px';
toggleBlindnessBtn.style.cursor = 'pointer';
document.body.appendChild(toggleBlindnessBtn);

let blindnessEnabled = true;
toggleBlindnessBtn.addEventListener('click', function() {
  blindnessEnabled = !blindnessEnabled;
  if (!blindnessEnabled) {
    // Turn off the blindness effect
    document.removeEventListener('mousemove', spotlightHandler);
    spotlightActive = false;
    blindnessOverlay.style.background = 'rgba(0,0,0,0)';
    toggleBlindnessBtn.textContent = 'Turn Blindness On (Not Boring!!)';
  } else {
    // Turn it back on
    document.addEventListener('mousemove', spotlightHandler);
    toggleBlindnessBtn.textContent = 'Turn Blindness Off (Boring!!)';
  }
});
      window.addEventListener('scroll', function() {
        if (!ticking) {
          window.requestAnimationFrame(function() {
            handleScroll();
            ticking = false;
          });
          ticking = true;
        }
      });
      handleScroll();
    });
  </script>
</body>
</html>
